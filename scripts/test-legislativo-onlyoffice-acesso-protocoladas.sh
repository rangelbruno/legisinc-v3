#!/bin/bash

echo "üèõÔ∏è Teste: Legislativo tem acesso a todas as proposi√ß√µes protocoladas"
echo "==================================================================="

echo ""
echo "1. Verificando proposi√ß√µes dispon√≠veis no sistema:"
docker exec legisinc-postgres psql -U postgres -d legisinc -c "SELECT id, tipo, status, numero_protocolo FROM proposicoes ORDER BY id;"

echo ""
echo "2. Status inclu√≠dos na listagem do Legislativo:"
echo "   ‚úÖ enviado_legislativo"
echo "   ‚úÖ em_revisao"
echo "   ‚úÖ devolvido_correcao"
echo "   ‚úÖ aprovado (NOVO)"
echo "   ‚úÖ aprovado_assinatura (NOVO)" 
echo "   ‚úÖ assinado (NOVO)"
echo "   ‚úÖ protocolado (NOVO)"

echo ""
echo "3. Badges de status adicionados na view:"
echo "   üìã Aprovado ‚Üí badge verde com √≠cone check"
echo "   ‚è≥ Aguardando Assinatura ‚Üí badge azul com √≠cone clock"
echo "   ‚úçÔ∏è Assinado ‚Üí badge verde com √≠cone signature"
echo "   üìã Protocolado ‚Üí badge verde escuro com √≠cone stamp"

echo ""
echo "4. Permiss√µes por status:"
echo "   Status edit√°veis pelo Legislativo:"
echo "   - enviado_legislativo, em_revisao, devolvido_correcao"
echo "   "
echo "   Status apenas visualiza√ß√£o:"
echo "   - aprovado, aprovado_assinatura, assinado, protocolado"

echo ""
echo "‚úÖ CORRE√á√ïES IMPLEMENTADAS:"
echo "   - ProposicaoLegislativoController.php: Query incluindo todos os status"
echo "   - legislativo/index.blade.php: Badges para novos status"
echo "   - Permiss√µes mantidas: Edi√ß√£o s√≥ para status apropriados"
echo "   - Estat√≠sticas atualizadas incluindo novos status"

echo ""
echo "üß™ TESTE NO NAVEGADOR:"
echo "   1. Login: joao@sistema.gov.br / 123456 (Legislativo)"
echo "   2. Acesse: http://localhost:8001/proposicoes/legislativo"
echo "   3. Deve ver TODAS as proposi√ß√µes, incluindo protocoladas"
echo "   4. Proposi√ß√µes protocoladas: apenas op√ß√£o 'Visualizar'"
echo "   5. Proposi√ß√µes em revis√£o: op√ß√µes 'Visualizar' e 'Editar'"

echo ""
echo "üìä RESULTADO ESPERADO:"
echo "   - Legislativo v√™ proposi√ß√µes 2 e 3 (ambas protocoladas)"
echo "   - Badge 'Protocolado' com √≠cone de carimbo"
echo "   - Clique em 'Visualizar' abre a proposi√ß√£o"
echo "   - PDF dispon√≠vel para visualiza√ß√£o"

echo ""
echo "‚úÖ Implementa√ß√£o conclu√≠da! Legislativo agora tem acesso completo ao hist√≥rico."